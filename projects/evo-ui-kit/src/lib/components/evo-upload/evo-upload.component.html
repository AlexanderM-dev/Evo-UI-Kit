<div class="evo-upload">
    <label class="evo-upload__wrapper"
           [evoUiClass]="{over: states.isDragOver}"
           (dragover)="handleDragOver($event)"
           (dragleave)="handleDragLeave($event)"
           (drop)="handleDrop($event)">
        <evo-icon class="evo-upload__upload-icon" shape="upload"></evo-icon>
        <span class="evo-upload__title">{{ dropZoneLabel }}</span>

        <span class="evo-upload__hint">
            или <span class="evo-upload__fake-link">загрузите</span>
            <ng-container *ngIf="dropZoneHint">
                (<span [innerHTML]="dropZoneHint | safeHtml"></span>)
            </ng-container>
        </span>

        <input
            class="evo-upload__input"
            (change)="processFiles($event.target.files)"
            [accept]="accept"
            [disabled]="loading"
            [multiple]="multiple"
            type="file"
            #inputFile />
    </label>

    <evo-alert *ngIf="filesForm.errors?.maxFiles" type="danger">
        <ng-container *ngIf="maxFiles && multiple">Нельзя загрузить более {{ maxFiles | declination:["файла", "файлов", "файлов"] }}</ng-container>
        <ng-container *ngIf="!multiple">Нельзя загрузить более 1 файла</ng-container>
    </evo-alert>

    <ul class="evo-upload__list">
        <li class="evo-upload__list-item" *ngFor="let file of filesForm.controls; let i = index">
            <evo-icon class="evo-upload__file-icon" shape="file" svgWidth="24" svgHeight="24"></evo-icon>
            {{ file.value.name }}

            <evo-icon
                class="evo-upload__button-remove"
                shape="decline"
                svgWidth="24"
                svgHeight="24"
                (click)="handleItemRemove(i)"
                [evoUiClass]="{disabled: loading}"></evo-icon>

            <div class="evo-upload__list-delimiter"
                 [evoUiClass]="{error: filesForm.controls[i].errors}"
                 [ngSwitch]="getControlError(filesForm.controls[i])">
                <ng-container *ngSwitchCase="'size'">Размер файла превышает допустимый</ng-container>
                <ng-container *ngSwitchCase="'extension'">Неверный формат файла</ng-container>
            </div>
        </li>
    </ul>

    <div class="evo-upload__controls" *ngIf="filesForm.controls.length">
        <button evo-button color="darkblue-lined" (click)="handleResetButtonClick()" [disabled]="loading">
            Удалить всё
        </button>
        <button evo-button color="green" (click)="handleSubmitButtonClick()" [disabled]="filesForm.invalid || loading" [loading]="loading">
            Отправить
        </button>
    </div>
</div>
